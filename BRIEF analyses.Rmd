---
title: Language Not Auditory Experience is Related to Parent-Reported Executive Functioning
  in Preschool-Aged Deaf and Hard of Hearing Children
  
output:
  html_document: default
  pdf_document: default
---

```{r echo=FALSE}
knitr::opts_chunk$set(root.dir = '/Desktop', echo = TRUE)
```

## Load Packages  
Load the following libraries. If they are not installed, run install.packages ("packagename")
```{r results='hide', warning=FALSE, message=FALSE}
#from https://www.vikram-baliga.com/blog/2015/7/19/a-hassle-free-way-to-verify-that-r-packages-are-installed-and-loaded
packages = c("tidyverse","ggplot2","beeswarm","colorspace", "stargazer", "qwraps2", "gridExtra","ggpubr","car","olsrr","ggbeeswarm", "broom", "rmarkdown", "table1", "kableExtra", "epitools", "FSA", "Hmisc", "userfriendlyscience")
package.check <- lapply(packages, FUN = function(x) {
  if (!require(x, character.only = TRUE)) {
    install.packages(x, dependencies = TRUE)
    library(x, character.only = TRUE)
  }
})

#verify they are loaded
search()
```

## Setup Dataframes
First, import the data from the data (CSV) file
```{r echo=FALSE}
#setwd("~/Desktop") 
setwd("/Users/emilycarrigan/Dropbox/Data Analysis Work/")
BRIEF <- read.csv("BRIEF_SLaM&CGdata_CG_200423.csv", na.strings = c("N/A", "", "Unknown", "Excluded"))
```
***  
Then, subset imported dataframe to remove participants missing age or SES information  
<ul>
  <li>**139 children**</li>
</ul>  
Add 4 columns:  
<ul>
  <li>Language Modality</li>
  <li>Language Timing</li>
  <li>4-group split</li>
  <li>3-way group split</li>
</ul>  

```{r}
BRIEF <- subset(BRIEF, BRIEF$AgeMonths < 100 & BRIEF$AgeMonths!="" & BRIEF$SES..3.66.!="")

BRIEF$Language_Modality <- factor(ifelse(BRIEF$Group_4cat == "English Early" | BRIEF$Group_4cat == "English Later", "English", "ASL"), levels = c("English", "ASL"))
BRIEF$Language_Timing <- factor(as.character(BRIEF$Group_2cat), levels = c("Early", "Later"), exclude="")

BRIEF$LanguageGroup <- as.factor(factor(as.character(BRIEF$Group_4cat), levels = c("English Early", "ASL Early", "English Later", "ASL Later"), labels = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"), exclude=NA))

BRIEF$Hearing_Level_3_Cat <- as.factor(factor(as.character(BRIEF$Hearing_Level_3_Cat), levels = c("TH", "deaf", "HoH"), labels = c("Typically Hearing", "Deaf", "Hard of Hearing"), exclude=NA))


BRIEF$Hearing.Device <- dplyr::recode(BRIEF$Hearing.Device, "BAHA" = "Other")
BRIEF$Hearing.Device <- as.factor(factor(as.character(BRIEF$Hearing.Device), levels = c("HA", "CI", "HA & CI", "Other", "None"), labels = c("Hearing Aid", "Cochlear Implant", "Hearing Aid & Cochlear Implant", "Other", "None"), exclude=NA))

#Recode Race to have fewer categories
BRIEF$Race_recoded <- dplyr::recode(as.character(BRIEF$Race), 'Asian' = "Asian", 'Black or African American'="Black or African American", 'More than One'="More than one", 'Other'="Other/Missing", 'Unsure, or prefer not to answer' = "Other/Missing", 'White'="White", .missing="Other/Missing")

#update ORDER of groups
BRIEF$Race_recoded <- as.factor(factor(as.character(BRIEF$Race_recoded), levels = c("Asian", "Black or African American", "White", "More than one", "Other/Missing"), exclude=NA))

#Recode Ethnicity to have fewer categories
BRIEF$Ethnicity_recoded <- dplyr::recode(as.character(BRIEF$Ethnicity), 'Hispanic' = "Hispanic", 'NonHispanic'="Non-Hispanic", 'PreferNotToAnswer'="Prefer not to answer", .missing="Missing")

#update ORDER of groups
BRIEF$Ethnicity_recoded <- as.factor(factor(as.character(BRIEF$Ethnicity_recoded), levels = c("Hispanic", "Non-Hispanic", "Prefer not to answer", "Missing"), exclude=NA))


nrow(BRIEF)
```

Create dataframe with participants who are age appropriate for the BRIEF-P (less than 5;11 years old)  
<ul>
  <li>**110 children**</li>
</ul>  
```{r}
BRIEF_AgeApp <- subset(BRIEF, BRIEF$AgeMonths <= 71)
nrow(BRIEF_AgeApp)
```

Create dataframe for participants we have Age of Auditory and Language Exposure for, and remove participants for whom this information is missing
<ul>
  <li>*This is the dataframe used for linear models in Question 2*</li>
  <li>Update Age of Auditory Exposure to convert "None" to current age</li>
  <li>Change structure of Age of Auditory Exposure from character to integer</li>
  <li>**125 children**</li>
</ul>  
```{r}
BRIEF <- dplyr::mutate(BRIEF, AoAE = ifelse(BRIEF$Age.of.Auditory.Exposure..mo.=="None", as.character(BRIEF$AgeMonths), as.character(BRIEF$Age.of.Auditory.Exposure..mo.)))

BRIEF$AoAE <- as.integer(BRIEF$AoAE)

BRIEF_AgeOf <- subset(BRIEF, BRIEF$AoAE!='' & BRIEF$Age.of.Language.Exposure..mo.!='')

nrow(BRIEF_AgeOf)
```



## Demographic Information
#### Table 1.
```{r}
table1::label(BRIEF$AgeMonths) <- "Age (Months)"
table1::label(BRIEF$SES..3.66.) <- "SES"
table1::label(BRIEF$Sex) <- "Sex"
table1::label(BRIEF$Race_recoded) <- "Race"
table1::label(BRIEF$Ethnicity_recoded) <- "Ethnicity"

 
table1::table1(~AgeMonths + SES..3.66. + Sex + Race_recoded + Ethnicity_recoded  | LanguageGroup, data = BRIEF, overall=F)
```

#### Comparing SES across Language Groups
```{r}
ggboxplot(BRIEF, x = "LanguageGroup", y = "SES..3.66.", 
          color = "LanguageGroup",
          order = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"),
          ylab = "SES", xlab = "Language Group")
ggplot(data=BRIEF, mapping=aes(x=SES..3.66.))+ geom_histogram() + facet_grid(~LanguageGroup)
leveneTest(SES..3.66.~LanguageGroup, data=BRIEF)
SES_LangGrp <- kruskal.test(SES..3.66.~LanguageGroup, data=BRIEF)
SES_LangGrp 

dunnTest(SES..3.66.~LanguageGroup, data=BRIEF, method="hochberg")
#selected hochberg correction method referencing this site: https://towardsdatascience.com/an-overview-of-methods-to-address-the-multiple-comparison-problem-310427b3ba92

#Later ASL has significantly lower SES than typically hearing
```

#### Comparing Age across Language Groups
```{r}
ggboxplot(BRIEF, x = "LanguageGroup", y = "AgeMonths", 
          color = "LanguageGroup",
          order = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"),
          ylab = "Age (Months)", xlab = "Language Group")
ggplot(data=BRIEF, mapping=aes(x=AgeMonths))+ geom_histogram() + facet_grid(~LanguageGroup)
leveneTest(AgeMonths~LanguageGroup, data=BRIEF)
SES_LangGrp <- kruskal.test(AgeMonths~LanguageGroup, data=BRIEF)
SES_LangGrp 

dunnTest(AgeMonths~LanguageGroup, data=BRIEF, method="hochberg")
#Later ASL significantly older than TH
```


#### Table 2.
```{r}
table1::label(BRIEF$Hearing_Level_3_Cat) <- "Pre-device hearing level (3 Category)"
table1::label(BRIEF$Hearing.Device) <- "Type of Hearing Device"
table1::label(BRIEF$AoAE) <- "Age of First Auditory Exposure (Months)"
table1::label(BRIEF$Age.of.Language.Exposure..mo.) <- "Age of First Language Exposure (Months)"

table1::table1(~Hearing_Level_3_Cat + Hearing.Device + AoAE + Age.of.Language.Exposure..mo.| LanguageGroup, data = BRIEF, overall=F)
```



#### Comparing Age of Auditory Exposure across Language Groups
```{r}
ggboxplot(BRIEF, x = "LanguageGroup", y = "AoAE", 
          color = "LanguageGroup",
          order = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"),
          ylab = "Age of Auditory Exposure (Months)", xlab = "Language Group")
ggplot(data=BRIEF, mapping=aes(x=AoAE))+ geom_histogram() + facet_grid(~LanguageGroup)
leveneTest(AoAE~LanguageGroup, data=BRIEF)
SES_LangGrp <- kruskal.test(AoAE~LanguageGroup, data=BRIEF)
SES_LangGrp 

dunnTest(AoAE~LanguageGroup, data=BRIEF, method="hochberg")
#Typically hearing group has significantly earlier age of auditory exposure than all three DHH groups
#Later English participants have significantly earlier auditory experience than both Early and Later ASL
#Early and Later ASL groups did not differ in terms of their age of auditory exposure
```

#### Comparing Age of Language Exposure across Language Groups
```{r}
ggboxplot(BRIEF, x = "LanguageGroup", y = "Age.of.Language.Exposure..mo.", 
          color = "LanguageGroup",
          order = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"),
          ylab = "Age of Language Exposure (Months)", xlab = "Language Group")
ggplot(data=BRIEF, mapping=aes(x=Age.of.Language.Exposure..mo.))+ geom_histogram() + facet_grid(~LanguageGroup)
leveneTest(Age.of.Language.Exposure..mo.~LanguageGroup, data=BRIEF)
SES_LangGrp <- kruskal.test(Age.of.Language.Exposure..mo.~LanguageGroup, data=BRIEF)
SES_LangGrp 

dunnTest(Age.of.Language.Exposure..mo.~LanguageGroup, data=BRIEF, method="hochberg")
#
```

## Results  
#### **Question 1: How do children with early access to sign language but not auditory input compare in parent-reported executive functioning skills relative to typically hearing peers?**  
Compared (via Welch's t-tests) the EF skills (raw scores) of children with access to spoken language from birth via typical hearing (Early English group) to those of severe-to-profoundly deaf children exposed to a sign language from birth (Early ASL group) 

#### Table 3.
Create dataframe with only children exposed to language early and perform t-tests for all BRIEF-P scales  
```{r}
BRIEF_early <- subset(BRIEF_AgeOf, BRIEF_AgeOf$Language_Timing=="Early")
```
  
Welch two sample t-tests: Early ASL group did not differ from Typically Hearing group on any  subscale 
```{r}
table1::label(BRIEF_early$GEC_RawScore) <- "Global Executive Composite"
table1::label(BRIEF_early$Inhibit_RawScore) <- "Inhibition"
table1::label(BRIEF_early$Shift_RawScore) <- "Shift"
table1::label(BRIEF_early$Emotional.Control_RawScore) <- "Emotional Control"
table1::label(BRIEF_early$Working.Memory_RawScore) <- "Working Memory"
table1::label(BRIEF_early$Plan.Organize_RawScore) <- "Plan/Organize"

table1(~GEC_RawScore + Inhibit_RawScore + Shift_RawScore + Emotional.Control_RawScore + Working.Memory_RawScore + Plan.Organize_RawScore | Language_Modality, data = BRIEF_early, overall=F)

t.test(BRIEF_early$GEC_RawScore~BRIEF_early$Language_Modality)
t.test(BRIEF_early$Inhibit_RawScore~BRIEF_early$Language_Modality)
t.test(BRIEF_early$Shift_RawScore~BRIEF_early$Language_Modality)
t.test(BRIEF_early$Emotional.Control_RawScore~BRIEF_early$Language_Modality)
t.test(BRIEF_early$Working.Memory_RawScore~BRIEF_early$Language_Modality)
t.test(BRIEF_early$Plan.Organize_RawScore~BRIEF_early$Language_Modality)

```
  
#### **Question 2: How do age of access to auditory input and age of language exposure relate to parent-reported executive functioning?**  
Linear regression models for the BRIEF-P composite scale and each subscale (raw scores) that characterizes the contributions of age of auditory and language exposure, as well as other relevant characteristics (e.g., SES, sex, age). 

####Checking correlations between predictors
```{r}
##predictors <- BRIEF_AgeOf[, c("SES..3.66.", "Sex", "AgeMonths", "Age.of.Language.Exposure..mo.", "AoAE", "Hearing_Level_3_Cat", "Language_Modality")]
num_predictors <- BRIEF_AgeOf[, c("SES..3.66.", "AgeMonths", "Age.of.Language.Exposure..mo.", "AoAE")]
flattenCorrMatrix <- function(cormat, pmat) {
  ut <- upper.tri(cormat)
  data.frame(
    row = rownames(cormat)[row(cormat)[ut]],
    column = rownames(cormat)[col(cormat)[ut]],
    cor  =(cormat)[ut],
    p = pmat[ut]
    )
}
BRIEF_num_pred <- rcorr(as.matrix(num_predictors), type = c("pearson"))
flattenCorrMatrix(BRIEF_num_pred$r, BRIEF_num_pred$P)

```


##### **Global Executive Composite Models**
* Base Model:  
```{r}
overall_all_base <- lm(data=BRIEF_AgeOf, formula = GEC_RawScore~SES..3.66.+Sex+AgeMonths)
summary(overall_all_base)
```
* Add Age of Language Exposure:  
```{r}
overall_all_AoLE <- lm(data=BRIEF_AgeOf, formula = GEC_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.)
summary(overall_all_AoLE) 
```
* Add Age of Auditory Exposure:
```{r}
overall_all_AoLE_AoAE <- lm(data=BRIEF_AgeOf, formula = GEC_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+AoAE)
summary(overall_all_AoLE_AoAE) 
```
* Add Length of Auditory Experience:
```{r}
overall_all_AoLE_LoAE <- lm(data=BRIEF_AgeOf, formula = GEC_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+Length.of.Auditory.Exposure)
summary(overall_all_AoLE_LoAE) 
```
* Add Modality:
```{r}
overall_all_AoLE_Modality <- lm(data=BRIEF_AgeOf, formula = GEC_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+Language_Modality)
summary(overall_all_AoLE_Modality) 
```
* Add Hearing Status (3-category):
    + Change Hearing Status reference group to Hearing 
```{r}
overall_all_AoLE_HearStat <- lm(data=BRIEF_AgeOf, formula = GEC_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+ Hearing_Level_3_Cat)
summary(overall_all_AoLE_HearStat)
```
Supplementary Materials: Comparing Global Executive Composite Models. 
```{r GEC model comparison, echo=T, results='hide', message=FALSE, warning=FALSE}
stargazer(overall_all_base, overall_all_AoLE, overall_all_AoLE_AoAE, overall_all_AoLE_LoAE, overall_all_AoLE_Modality,overall_all_AoLE_HearStat, type= "html", title = "Linear Regression Results", align=TRUE, dep.var.labels=c("Global Executive Composite Raw Scores"), covariate.labels=c("Socioeconomic Status (SES)", "Sex (Male)", "Age (Months)", "Age of Exposure to Language (Months)", "Age of Auditory Exposure (Months)", "Length of Auditory Exposure", "Language Modality (ASL)", "Hearing Status (Deaf)", "Hearing Status (HoH)"))
```

* **Checking assumptions for best-fit GEC model**
```{r}
ols_plot_resid_qq(overall_all_AoLE)
ols_test_normality(overall_all_AoLE)
ols_plot_resid_hist(overall_all_AoLE)
ols_test_correlation(overall_all_AoLE)
ols_plot_resid_fit(overall_all_AoLE)
```



##### **Inhibition Models**
* Base Model:
```{r}
inhibition_all_base <- lm(data=BRIEF_AgeOf, formula = Inhibit_RawScore~SES..3.66.+Sex+AgeMonths)
summary(inhibition_all_base)
```
* Add Age of Language Exposure:
```{r}
inhibition_all_AoLE <- lm(data=BRIEF_AgeOf, formula = Inhibit_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.)
summary(inhibition_all_AoLE)
```
* Add Age of Auditory Experience:
```{r}
inhibition_all_AoLE_AoAE <- lm(data=BRIEF_AgeOf, formula = Inhibit_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+AoAE)
summary(inhibition_all_AoLE_AoAE)
```
* Add Length of Auditory Exposure:
```{r}
inhibition_all_AoLE_LoAE <- lm(data=BRIEF_AgeOf, formula = Inhibit_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+Length.of.Auditory.Exposure)
summary(inhibition_all_AoLE_LoAE)
```
* Add Modality:
```{r}
inhibition_all_AoLE_Modality <- lm(data=BRIEF_AgeOf, formula = Inhibit_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+ Language_Modality)
summary(inhibition_all_AoLE_Modality)
```
* Add Hearing Status (3-category):
```{r}
inhibition_all_AoLE_HearStat <- lm(data=BRIEF_AgeOf, formula = Inhibit_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+ Hearing_Level_3_Cat)
summary(inhibition_all_AoLE_HearStat)
```
Supplementary Materials: Comparing Inhibition Models. 
```{r   Inhibition model comparison, echo=T, results='hide', message=FALSE, warning=FALSE}
stargazer(inhibition_all_base, inhibition_all_AoLE, inhibition_all_AoLE_AoAE, inhibition_all_AoLE_LoAE, inhibition_all_AoLE_Modality, inhibition_all_AoLE_HearStat, type= "html", title = "Linear Regression Results", align=TRUE, dep.var.labels=c("Inhibition Raw Scores"), covariate.labels=c("Socioeconomic Status (SES)", "Sex (Male)", "Age (Months)", "Age of Exposure to Language (Months)", "Age of Auditory Exposure (Months)", "Length of Auditory Exposure", "Language Modality (ASL)", "Hearing Status (Deaf)", "Hearing Status (HoH)"))
```
* **Checking assumptions for best-fit Inhibition model**
```{r}
ols_plot_resid_qq(inhibition_all_AoLE)
ols_test_normality(inhibition_all_AoLE)
ols_plot_resid_hist(inhibition_all_AoLE)
ols_test_correlation(inhibition_all_AoLE)
ols_plot_resid_fit(inhibition_all_AoLE)
```

##### **Shift Models**
* Base Model:
```{r}
shift_all_base <- lm(data=BRIEF_AgeOf, formula = Shift_RawScore~SES..3.66.+Sex+AgeMonths)
summary(shift_all_base)
```
* Add Age of Language Exposure:
```{r}
shift_all_AoLE <- lm(data=BRIEF_AgeOf, formula = Shift_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.)
summary(shift_all_AoLE)
```
* Add Age of Auditory Experience:
```{r}
shift_all_AoLE_AoAE <- lm(data=BRIEF_AgeOf, formula = Shift_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+AoAE)
summary(shift_all_AoLE_AoAE)
```
* Add Length of Auditory Exposure:
```{r}
shift_all_AoLE_LoAE <- lm(data=BRIEF_AgeOf, formula = Shift_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+Length.of.Auditory.Exposure)  
summary(shift_all_AoLE_LoAE) 
```
* Add Modality:
```{r}
shift_all_AoLE_Modality <- lm(data=BRIEF_AgeOf, formula = Shift_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+Language_Modality)  
summary(shift_all_AoLE_Modality) 
```
* Add Hearing Status (3-category):
```{r}
shift_all_AoLE_HearStat <- lm(data=BRIEF_AgeOf, formula = Shift_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+ Hearing_Level_3_Cat)
summary(shift_all_AoLE_HearStat)
```
Supplementary Materials: Comparing Shift Models. 
```{r   Shift model comparison, echo=T, results='hide', message=FALSE, warning=FALSE}
stargazer(shift_all_base, shift_all_AoLE, shift_all_AoLE_AoAE, shift_all_AoLE_LoAE, shift_all_AoLE_Modality, shift_all_AoLE_HearStat, type= "html", title = "Linear Regression Results", align=TRUE, dep.var.labels=c("Shift Raw Scores"), covariate.labels=c("Socioeconomic Status (SES)", "Sex (Male)", "Age (Months)", "Age of Exposure to Language (Months)", "Age of Auditory Exposure (Months)", "Length of Auditory Exposure", "Language Modality (ASL)", "Hearing Status (Deaf)", "Hearing Status (HoH)"))
```
* **Checking assumptions for best-fit Shift model**
```{r}
ols_plot_resid_qq(shift_all_AoLE)
ols_test_normality(shift_all_AoLE)
ols_plot_resid_hist(shift_all_AoLE)
ols_test_correlation(shift_all_AoLE)
ols_plot_resid_fit(shift_all_AoLE)
```

##### **Emotional Control Models**
* Base Model:
```{r}
emotctrl_all_base <- lm(data=BRIEF_AgeOf, formula = Emotional.Control_RawScore~SES..3.66.+Sex+AgeMonths)
summary(emotctrl_all_base)
```
* Add Age of Language Exposure:
```{r}
emotctrl_all_AoLE <- lm(data=BRIEF_AgeOf, formula = Emotional.Control_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.)
summary(emotctrl_all_AoLE)
```
* Add Age of Auditory Experience:
```{r}
emotctrl_all_AoLE_AoAE <- lm(data=BRIEF_AgeOf, formula = Emotional.Control_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+AoAE)
summary(emotctrl_all_AoLE_AoAE)
```
* Add Length of Auditory Experience:
```{r}
emotctrl_all_AoLE_LoAE <- lm(data=BRIEF_AgeOf, formula = Emotional.Control_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+Length.of.Auditory.Exposure)
summary(emotctrl_all_AoLE_LoAE)
```
* Add Modality:
```{r}
emotctrl_all_AoLE_Modality <- lm(data=BRIEF_AgeOf, formula = Emotional.Control_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+Language_Modality)
summary(emotctrl_all_AoLE_Modality)
```
* Add Hearing Status (3-category):
```{r}
emotctrl_all_AoLE_HearStat <- lm(data=BRIEF_AgeOf, formula = Emotional.Control_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+ Hearing_Level_3_Cat)
summary(emotctrl_all_AoLE_HearStat)
```
* Add Language Timing
```{r}
emotctrl_all_AoLE_Timing <- lm(data=BRIEF_AgeOf, formula = Emotional.Control_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+Language_Timing)
summary(emotctrl_all_AoLE_Timing)
```
Supplementary Materials: Comparing Emotional Control Models. 
```{r   Emotional Control model comparison, echo=T, results='hide', message=FALSE, warning=FALSE}
stargazer(emotctrl_all_base, emotctrl_all_AoLE, emotctrl_all_AoLE_AoAE, emotctrl_all_AoLE_LoAE, emotctrl_all_AoLE_Modality, emotctrl_all_AoLE_HearStat, type= "html", title = "Linear Regression Results", align=TRUE, dep.var.labels=c("BRIEF Emotional Control Raw Scores"), covariate.labels=c("Socioeconomic Status (SES)", "Sex (Male)", "Age (Months)", "Age of Exposure to Language (Months)", "Age of Auditory Exposure (Months)", "Length of Auditory Experience (Months)", "Language Modality (ASL)", "Hearing Status (Deaf)", "Hearing Status (HoH)", "Language Timing (Later)"))
```

* **No assumption checking for best-fit Emotional Control model because we did not find one that was a good fit for the data**


##### **Working Memory Models**
* Base Model:
```{r}
wm_all_base <- lm(data=BRIEF_AgeOf, formula = Working.Memory_RawScore~SES..3.66.+Sex+AgeMonths)
summary(wm_all_base) 
```
* Add Age of Language Exposure:
```{r}
wm_all_AoLE <- lm(data=BRIEF_AgeOf, formula = Working.Memory_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.)
summary(wm_all_AoLE)
```
* Add Age of Auditory Experience:
```{r}
wm_all_AoLE_AoAE <- lm(data=BRIEF_AgeOf, formula = Working.Memory_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+AoAE)
summary(wm_all_AoLE_AoAE)
```
* Add Length of Auditory Experience:
```{r}
wm_all_AoLE_LoAE <- lm(data=BRIEF_AgeOf, formula = Working.Memory_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+Length.of.Auditory.Exposure)
summary(wm_all_AoLE_LoAE)
```
* Add Modality:
```{r}
wm_all_AoLE_Modality <- lm(data=BRIEF_AgeOf, formula = Working.Memory_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+Language_Modality)
summary(wm_all_AoLE_Modality)
```
* Add Hearing Status (3-category):
```{r}
wm_all_AoLE_HearStat <- lm(data=BRIEF_AgeOf, formula = Working.Memory_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+ Hearing_Level_3_Cat)
summary(wm_all_AoLE_HearStat)
```
Supplementary Materials: Comparing Working Memory Models. 
```{r   Working Memory model comparison, echo=T, results='hide', message=FALSE, warning=FALSE}
stargazer(wm_all_base, wm_all_AoLE, wm_all_AoLE_AoAE, wm_all_AoLE_LoAE, wm_all_AoLE_Modality,wm_all_AoLE_HearStat, type= "html", title = "Linear Regression Results", align=TRUE, dep.var.labels=c("Working Memory Raw Scores"), covariate.labels=c("Socioeconomic Status (SES)", "Sex (Male)", "Age (Months)", "Age of Exposure to Language (Months)", "Age of Auditory Exposure (Months)", "Length of Auditory Exposure", "Language Modality (ASL)", "Hearing Status (Deaf)", "Hearing Status (HoH)"))
```
* **Checking assumptions for best-fit Working Memory model**
```{r}
ols_plot_resid_qq(wm_all_AoLE)
ols_test_normality(wm_all_AoLE)
ols_plot_resid_hist(wm_all_AoLE)
ols_test_correlation(wm_all_AoLE)
ols_plot_resid_fit(wm_all_AoLE)
```  

##### **Planning/Organization Models**
* Base Model:
```{r}
plan_all_base <- lm(data=BRIEF_AgeOf, formula = Plan.Organize_RawScore~SES..3.66.+Sex+AgeMonths)
summary(plan_all_base)
```  
* Add Age of Language Exposure:
```{r}
plan_all_AoLE <- lm(data=BRIEF_AgeOf, formula = Plan.Organize_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.)
summary(plan_all_AoLE)
```  
* Add Age of Auditory Experience:
```{r}
plan_all_AoLE_AoAE <- lm(data=BRIEF_AgeOf, formula = Plan.Organize_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+AoAE)
summary(plan_all_AoLE_AoAE)
``` 
* Add Length of Auditory Experience:
```{r}
plan_all_AoLE_LoAE <- lm(data=BRIEF_AgeOf, formula = Plan.Organize_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+Length.of.Auditory.Exposure)
summary(plan_all_AoLE_LoAE)
```  
* Add Modality:
```{r}
plan_all_AoLE_Modality <- lm(data=BRIEF_AgeOf, formula = Plan.Organize_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+Language_Modality)
summary(plan_all_AoLE_Modality)
```  
* Add Hearing Status (3-category):
```{r}
plan_all_AoLE_HearStat <- lm(data=BRIEF_AgeOf, formula = Plan.Organize_RawScore~SES..3.66.+Sex+AgeMonths+Age.of.Language.Exposure..mo.+ Hearing_Level_3_Cat)
summary(wm_all_AoLE_HearStat)
```  
Supplementary Materials: Comparing Planning/Organization Models. 
```{r Plan_organize model comparison, echo=T, results='hide', message=FALSE, warning=FALSE}
stargazer(plan_all_base, plan_all_AoLE, plan_all_AoLE_AoAE, plan_all_AoLE_LoAE, plan_all_AoLE_Modality,plan_all_AoLE_HearStat, type= "html", title = "Linear Regression Results", align=TRUE, dep.var.labels=c("BRIEF Planning/Organization Raw Scores"), covariate.labels=c("Socioeconomic Status (SES)", "Sex (Male)", "Age (Months)", "Age of Exposure to Language (Months)", "Length of Auditory Experience (Months)", "Language Modality (ASL)", "Hearing Status (Deaf)", "Hearing Status (HoH)"))
```  
* **Checking assumptions for best-fit Plan/Organize model**
```{r}
ols_plot_resid_qq(plan_all_AoLE)
ols_test_normality(plan_all_AoLE)
ols_plot_resid_hist(plan_all_AoLE)
ols_test_correlation(plan_all_AoLE)
ols_plot_resid_fit(plan_all_AoLE)
```  
#### Table 4.
```{r  Table4, echo=T, results='hide', message=FALSE, warning=FALSE}
stargazer(overall_all_AoLE_AoAE, inhibition_all_AoLE_AoAE, shift_all_AoLE_AoAE, emotctrl_all_AoLE_AoAE, wm_all_AoLE_AoAE, plan_all_AoLE_AoAE, type= "html", title = "Linear Regression Results for Raw Scores", align=TRUE, dep.var.labels=c("Global Executive Composite", "Inhibition", "Shift", "Emotional Control", "Working Memory", "Planning/Organization"), covariate.labels=c("Socioeconomic Status (SES)", "Sex (Male)", "Age (Months)", "Age of Exposure to Language (Months)", "Age of Auditory Exposure (Months)"))
```  



#### Figure 1.
```{r fig.width=16, fig.height=12, message=FALSE}
G <- ggplot(data=BRIEF_AgeApp, mapping = aes(x= Language_Timing, y=GEC_Tscore)) + geom_boxplot() + geom_dotplot(mapping=aes(fill=Language_Modality, color=Language_Modality), dotsize = 1.1, method = "dotdensity", binaxis = "y", stackdir = "center", alpha=0.8) + theme(text = element_text(size=20), axis.title=element_text(size=20,face="bold"), legend.title=element_text(size=24), legend.text=element_text(size=24), axis.title.x=element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + ylab("Global Executive Composite (T-scores)") + scale_x_discrete(labels=c("Early" = "Early Language", "Later" = "Later Language")) + scale_y_continuous(limits= c(30, 100), breaks= c(30, 40, 50, 60, 70, 80, 90, 100)) + scale_fill_manual(name = "Language Modality", values=c("slateblue4", "gold"), breaks=c("English", "ASL"), labels=c("English", "ASL")) + scale_color_manual(name = "Language Modality", values=c("slateblue4", "gold"), breaks=c("English", "ASL"), labels=c("English", "ASL")) + geom_hline(aes(yintercept= 50, linetype = "Mean"), colour= 'black') + geom_hline(aes(yintercept= 65, linetype = "Elevated"), colour= 'red') + scale_linetype_manual(name = "Standard Score", values=c("dotdash", "longdash"), guide = guide_legend(override.aes = list(color = c("red", "black"))))

I <- ggplot(data=BRIEF_AgeApp, mapping = aes(x= Language_Timing, y=Inhibit_Tscore)) + geom_boxplot() + geom_dotplot(mapping=aes(fill=Language_Modality, color=Language_Modality), dotsize = 1.1, method = "dotdensity", binaxis = "y", stackdir = "center", alpha=0.8) + theme(text = element_text(size=20), axis.title=element_text(size=20,face="bold"), legend.title=element_text(size=24), legend.text=element_text(size=24), axis.title.x=element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + ylab("Inhibition (T-scores)") + scale_x_discrete(labels=c("Early" = "Early Language", "Later" = "Later Language")) + scale_y_continuous(limits= c(30, 100), breaks= c(30, 40, 50, 60, 70, 80, 90, 100)) + scale_fill_manual(name = "Language Modality", values=c("slateblue4", "gold"), breaks=c("English", "ASL"), labels=c("English", "ASL")) + scale_color_manual(name = "Language Modality", values=c("slateblue4", "gold"), breaks=c("English", "ASL"), labels=c("English", "ASL")) + geom_hline(aes(yintercept= 50, linetype = "Mean"), colour= 'black') + geom_hline(aes(yintercept= 65, linetype = "Elevated"), colour= 'red') + scale_linetype_manual(name = "Standard Score", values=c("dotdash", "longdash"), guide = guide_legend(override.aes = list(color = c("red", "black"))))


S <- ggplot(data=BRIEF_AgeApp, mapping = aes(x= Language_Timing, y=Shift_Tscore)) + geom_boxplot() + geom_dotplot(mapping=aes(fill=Language_Modality, color=Language_Modality), dotsize = 1.1, method = "dotdensity", binaxis = "y", stackdir = "center", alpha=0.8) + theme(text = element_text(size=20), axis.title=element_text(size=20,face="bold"), legend.title=element_text(size=24), legend.text=element_text(size=24), axis.title.x=element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + ylab("Shift (T-scores)") + scale_x_discrete(labels=c("Early" = "Early Language", "Later" = "Later Language")) + scale_y_continuous(limits= c(30, 100), breaks= c(30, 40, 50, 60, 70, 80, 90, 100)) + scale_fill_manual(name = "Language Modality", values=c("slateblue4", "gold"), breaks=c("English", "ASL"), labels=c("English", "ASL")) + scale_color_manual(name = "Language Modality", values=c("slateblue4", "gold"), breaks=c("English", "ASL"), labels=c("English", "ASL")) + geom_hline(aes(yintercept= 50, linetype = "Mean"), colour= 'black') + geom_hline(aes(yintercept= 65, linetype = "Elevated"), colour= 'red') + scale_linetype_manual(name = "Standard Score", values=c("dotdash", "longdash"), guide = guide_legend(override.aes = list(color = c("red", "black"))))

E <- ggplot(data=BRIEF_AgeApp, mapping = aes(x= Language_Timing, y= Emotional.Control_Tscore)) + geom_boxplot() + geom_dotplot(mapping=aes(fill=Language_Modality, color=Language_Modality), dotsize = 1.1, method = "dotdensity", binaxis = "y", stackdir = "center", alpha=0.8) + theme(text = element_text(size=20), axis.title=element_text(size=20,face="bold"), legend.title=element_text(size=24), legend.text=element_text(size=24), axis.title.x=element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + ylab("Emotional Control (T-scores)") + scale_x_discrete(labels=c("Early" = "Early Language", "Later" = "Later Language")) + scale_y_continuous(limits= c(30, 100), breaks= c(30, 40, 50, 60, 70, 80, 90, 100)) + scale_fill_manual(name = "Language Modality", values=c("slateblue4", "gold"), breaks=c("English", "ASL"), labels=c("English", "ASL")) + scale_color_manual(name = "Language Modality", values=c("slateblue4", "gold"), breaks=c("English", "ASL"), labels=c("English", "ASL")) + geom_hline(aes(yintercept= 50, linetype = "Mean"), colour= 'black') + geom_hline(aes(yintercept= 65, linetype = "Elevated"), colour= 'red') + scale_linetype_manual(name = "Standard Score", values=c("dotdash", "longdash"), guide = guide_legend(override.aes = list(color = c("red", "black"))))

W <- ggplot(data=BRIEF_AgeApp, mapping = aes(x= Language_Timing, y= Working.Memory_Tscore)) + geom_boxplot() + geom_dotplot(mapping=aes(fill=Language_Modality, color=Language_Modality), dotsize = 1.1, method = "dotdensity", binaxis = "y", stackdir = "center", alpha=0.8) + theme(text = element_text(size=20), axis.title=element_text(size=20,face="bold"), legend.title=element_text(size=24), legend.text=element_text(size=24), axis.title.x=element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"))  + ylab("Working Memory (T-scores)") + scale_x_discrete(labels=c("Early" = "Early Language", "Later" = "Later Language")) + scale_y_continuous(limits= c(30, 100), breaks= c(30, 40, 50, 60, 70, 80, 90, 100)) + scale_fill_manual(name = "Language Modality", values=c("slateblue4", "gold"), breaks=c("English", "ASL"), labels=c("English", "ASL")) + scale_color_manual(name = "Language Modality", values=c("slateblue4", "gold"), breaks=c("English", "ASL"), labels=c("English", "ASL")) + geom_hline(aes(yintercept= 50, linetype = "Mean"), colour= 'black') + geom_hline(aes(yintercept= 65, linetype = "Elevated"), colour= 'red') + scale_linetype_manual(name = "Standard Score", values=c("dotdash", "longdash"), guide = guide_legend(override.aes = list(color = c("red", "black"))))

P <- ggplot(data=BRIEF_AgeApp, mapping = aes(x= Language_Timing, y= Plan.Organize_Tscore)) + geom_boxplot() + geom_dotplot(mapping=aes(fill=Language_Modality, color=Language_Modality), dotsize = 1.1, method = "dotdensity", binaxis = "y", stackdir = "center", alpha=0.8) + theme(text = element_text(size=20), axis.title=element_text(size=20,face="bold"), legend.title=element_text(size=24), legend.text=element_text(size=24), axis.title.x=element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black")) + ylab("Plan/Organize (T-scores)") + scale_x_discrete(labels=c("Early" = "Early Language", "Later" = "Later Language")) + scale_y_continuous(limits= c(30, 100), breaks= c(30, 40, 50, 60, 70, 80, 90, 100)) + scale_fill_manual(name = "Language Modality", values=c("slateblue4", "gold"), breaks=c("English", "ASL"), labels=c("English", "ASL")) + scale_color_manual(name = "Language Modality", values=c("slateblue4", "gold"), breaks=c("English", "ASL"), labels=c("English", "ASL")) + geom_hline(aes(yintercept= 50, linetype = "Mean"), colour= 'black') + geom_hline(aes(yintercept= 65, linetype = "Elevated"), colour= 'red') + scale_linetype_manual(name = "Standard Score", values=c("dotdash", "longdash"), guide = guide_legend(override.aes = list(color = c("red", "black"))))

ggarrange(G, I, S, E, W, P, ncol=3, nrow=2, common.legend = TRUE, legend="bottom")

```  
  
  
#### **Question 3: Do children with later or degraded access to auditory and/or language input exhibit clinically significant deficits in executive functioning skills based on their BRIEF-P standard scores?**

Supplementary Materials: Demographic Information for Standard Score Subset
```{r}
table1::label(BRIEF_AgeApp$AgeMonths) <- "Age (Months)"
table1::label(BRIEF_AgeApp$Sex) <- "Sex"
table1::label(BRIEF_AgeApp$Race) <- "Race"
table1::label(BRIEF_AgeApp$Ethnicity) <- "Ethnicity"
table1::label(BRIEF_AgeApp$SES..3.66.) <- "SES"
 
table1::table1(~AgeMonths + Sex + Race + Ethnicity + SES..3.66. | LanguageGroup, data = BRIEF_AgeApp, overall=F)
```

#### Table 5 data & analyses 
##### **Risk Ratios (Relative Risk) and 95% confidence intervals for Global Executive Composite T-scores**
```{r}
BRIEF_AgeApp_GEC_over65 <- BRIEF_AgeApp %>% 
    group_by(LanguageGroup) %>% 
    summarise("Global Executive Composite T-score < 65 (n)" = sum(GEC_Tscore < 65), "Global Executive Composite T-score > 65 (n)" = sum(GEC_Tscore >= 65))

BRIEF_AgeApp_GEC_over65 %>%
    kable() %>%  
    kable_styling(bootstrap_options = "striped")

GEC_rr <- matrix(c(41, 3, 20, 1, 26, 3, 13, 3), 4, 2, byrow=TRUE)
dimnames(GEC_rr) <- list("Group" = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"), "GEC T-score" = c("Not Clinically Significant", "Clinically Significant"))
GEC_rr
riskratio.small(GEC_rr, verbose=TRUE)
```
  
##### **Inhibit Risk Ratios and 95% Confidence Intervals**
```{r}
BRIEF_AgeApp_Inhibit_over65 <- BRIEF_AgeApp %>% 
    group_by(LanguageGroup) %>% 
    summarise("Inhibit T-score < 65 (n)" = sum(Inhibit_Tscore < 65), "Inhibit T-score > 65 (n)" = sum(Inhibit_Tscore >= 65))

BRIEF_AgeApp_Inhibit_over65 %>%
    kable() %>%  
    kable_styling(bootstrap_options = "striped")

Inhibit_rr <- matrix(c(42,2, 19, 2, 27, 2, 15, 1), 4, 2, byrow=TRUE)
dimnames(Inhibit_rr) <- list("Group" = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"), "GEC T-score" = c("Not Clinically Significant", "Clinically Significant"))
Inhibit_rr
riskratio.small(Inhibit_rr)


```
  
##### **Shift Risk Ratios and 95% Confidence Intervals**
```{r}
BRIEF_AgeApp_Shift_over65 <- BRIEF_AgeApp %>% 
    group_by(LanguageGroup) %>% 
    summarise("Shift T-score < 65 (n)" = sum(Shift_Tscore < 65), "Shift T-score > 65 (n)" = sum(Shift_Tscore >= 65))

BRIEF_AgeApp_Shift_over65 %>%
    kable() %>%  
    kable_styling(bootstrap_options = "striped")

Shift_rr <- matrix(c(42,2,20,1, 26, 3, 15, 1), 4, 2, byrow=TRUE)
dimnames(Shift_rr) <- list("Group" = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"), "Shift T-score" = c("Not Clinically Significant", "Clinically Significant"))
Shift_rr
riskratio.small(Shift_rr)
```
  
##### **Emotional Control Risk Ratios and 95% Confidence Intervals**
```{r}
BRIEF_AgeApp_EmoCtrl_over65 <- BRIEF_AgeApp %>% 
    group_by(LanguageGroup) %>% 
    summarise("Emotional Control T-score < 65 (n)" = sum(Emotional.Control_Tscore < 65), "Emotional Control T-score > 65 (n)" = sum(Emotional.Control_Tscore >= 65))

BRIEF_AgeApp_EmoCtrl_over65 %>%
    kable() %>%  
    kable_styling(bootstrap_options = "striped")

EmoCtrl_rr <- matrix(c(41,3,21,0, 27, 2, 14, 2), 4, 2, byrow=TRUE)
dimnames(EmoCtrl_rr) <- list("Group" = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"), "Emotional Control T-score" = c("Not Clinically Significant", "Clinically Significant"))
EmoCtrl_rr
riskratio.small(EmoCtrl_rr)
```
  
##### **Working Memory Risk Ratios and 95% Confidence Intervals**
```{r}
BRIEF_AgeApp_WorkMem_over65 <- BRIEF_AgeApp %>% 
    group_by(LanguageGroup) %>% 
    summarise("Working Memory T-score < 65 (n)" = sum(Working.Memory_Tscore < 65), "Working Memory T-score > 65 (n)" = sum(Working.Memory_Tscore >= 65))

BRIEF_AgeApp_WorkMem_over65 %>%
    kable() %>%  
    kable_styling(bootstrap_options = "striped")

WorkMem_rr <- matrix(c(39,5,18,3, 25, 4, 14, 2), 4, 2, byrow=TRUE)
dimnames(WorkMem_rr) <- list("Group" = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"), "Working Memory T-score" = c("Not Clinically Significant", "Clinically Significant"))
WorkMem_rr
riskratio.small(WorkMem_rr)
```
  
##### **Plan/Organize Risk Ratios and 95% Confidence Intervals**
```{r}
BRIEF_AgeApp_PlanOrg_over65 <- BRIEF_AgeApp %>% 
    group_by(LanguageGroup) %>% 
    summarise("Plan/Organize T-score < 65 (n)" = sum(Plan.Organize_Tscore < 65), "Plan/Organize T-score > 65 (n)" = sum(Plan.Organize_Tscore >= 65))

BRIEF_AgeApp_PlanOrg_over65 %>%
    kable() %>%  
    kable_styling(bootstrap_options = "striped")

PlanOrg_rr <- matrix(c(41,3,20,1, 25, 4, 15, 1), 4, 2, byrow=TRUE)
dimnames(PlanOrg_rr) <- list("Group" = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"), "Plan/Organize T-score" = c("Not Clinically Significant", "Clinically Significant"))
PlanOrg_rr
riskratio.small(PlanOrg_rr)
```


#### Supplementary Materials, Relative Risk of Clinically-Elevated (T-score â‰¥ 60) Executive Functioning Deficits in DHH Participants

##### **Risk Ratios (Relative Risk) and 95% confidence intervals for Global Executive Composite T-scores > 60**
```{r}
BRIEF_AgeApp_GEC_over60 <- BRIEF_AgeApp %>% 
    group_by(LanguageGroup) %>% 
    summarise("Global Executive Composite T-score < 60 (n)" = sum(GEC_Tscore < 60), "Global Executive Composite T-score > 60 (n)" = sum(GEC_Tscore >= 60))

BRIEF_AgeApp_GEC_over60 %>%
    kable() %>%  
    kable_styling(bootstrap_options = "striped")

GEC_60rr <- matrix(c(39,5,18,3, 21, 8, 11, 5), 4, 2, byrow=TRUE)
dimnames(GEC_60rr) <- list("Group" = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"), "GEC T-score" = c("Not Elevated", "Elevated"))
GEC_60rr
riskratio.small(GEC_60rr)

#DHH groups not significantly more likely to have elevated GEC T-scores relative to TH group, but the two later groups are close
```
  
##### **Inhibit T-scores > 60 Risk Ratios and 95% Confidence Intervals**
```{r}
BRIEF_AgeApp_Inhibit_over60 <- BRIEF_AgeApp %>% 
    group_by(LanguageGroup) %>% 
    summarise("Inhibit T-score < 60 (n)" = sum(Inhibit_Tscore < 60), "Inhibit T-score > 60 (n)" = sum(Inhibit_Tscore >= 60))

BRIEF_AgeApp_Inhibit_over60 %>%
    kable() %>%  
    kable_styling(bootstrap_options = "striped")

Inhibit_60rr <- matrix(c(39,5,17,4, 25, 4, 11, 5), 4, 2, byrow=TRUE)
dimnames(Inhibit_60rr) <- list("Group" = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"), "Inhibit T-score" = c("Not Elevated", "Elevated"))
Inhibit_60rr
riskratio.small(Inhibit_60rr)
#DHH groups *not* significantly more likely to have elevated Inhibit T-scores relative to TH group, but the Later ASL group close
```
  
##### **Shift T-scores > 60 Risk Ratios and 95% Confidence Intervals**
```{r}
BRIEF_AgeApp_Shift_over60 <- BRIEF_AgeApp %>% 
    group_by(LanguageGroup) %>% 
    summarise("Shift T-score < 60 (n)" = sum(Shift_Tscore < 60), "Shift T-score > 60 (n)" = sum(Shift_Tscore >= 60))

BRIEF_AgeApp_Shift_over60 %>%
    kable() %>%  
    kable_styling(bootstrap_options = "striped")

Shift_60rr <- matrix(c(42,2,19,2, 26, 2, 12, 4), 4, 2, byrow=TRUE)
dimnames(Shift_60rr) <- list("Group" = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"), "Shift T-score" = c("Not Elevated", "Elevated"))
Shift_60rr
riskratio.small(Shift_60rr)
#Later ASL group significantly more likely to have elevated Shift T-scores relative to TH group (3.75 times more likely) according to p-values (even though risk ratio CI does include 1)
```
  
##### **Emotional Control T-scores > 60 Risk Ratios and 95% Confidence** Intervals
```{r}
BRIEF_AgeApp_EmoCtrl_over60 <- BRIEF_AgeApp %>% 
    group_by(LanguageGroup) %>% 
    summarise("Emotional Control T-score < 60 (n)" = sum(Emotional.Control_Tscore < 60), "Emotional Control T-score > 60 (n)" = sum(Emotional.Control_Tscore >= 60))

BRIEF_AgeApp_EmoCtrl_over60 %>%
    kable() %>%  
    kable_styling(bootstrap_options = "striped")

EmoCtrl_60rr <- matrix(c(33,11, 19,2, 27,2, 13,3), 4, 2, byrow=TRUE)
dimnames(EmoCtrl_60rr) <- list("Group" = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"), "Emotional Control T-score" = c("Not Elevated", "Elevated"))
EmoCtrl_60rr
riskratio.small(EmoCtrl_60rr)
#Later English borderline *less* likely than TH to have elevated Emotional Control T-scores (but there do seem to be)
```
  
##### **Working Memory T-scores > 60 Risk Ratios and 95% Confidence Intervals**
```{r}
BRIEF_AgeApp_WorkMem_over60 <- BRIEF_AgeApp %>% 
    group_by(LanguageGroup) %>% 
    summarise("Working Memory T-score < 60 (n)" = sum(Working.Memory_Tscore < 60), "Working Memory T-score > 60 (n)" = sum(Working.Memory_Tscore >= 60))

BRIEF_AgeApp_WorkMem_over60 %>%
    kable() %>%  
    kable_styling(bootstrap_options = "striped")

WorkMem_60rr <- matrix(c(38,6,17,4,21,8,9,7), 4, 2, byrow=TRUE)
dimnames(WorkMem_60rr) <- list("Group" = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"), "Working Memory T-score" = c("Not Elevated", "Elevated"))
WorkMem_60rr
riskratio.small(WorkMem_60rr)
#Later ASL significantly more likely to have elevated Working Memory T-scores relative to TH group
```
  
##### **Plan/Organize T-scores > 60 Risk Ratios and 95% Confidence Intervals**
```{r}
BRIEF_AgeApp_PlanOrg_over60 <- BRIEF_AgeApp %>% 
    group_by(LanguageGroup) %>% 
    summarise("Plan/Organize T-score < 60 (n)" = sum(Plan.Organize_Tscore < 60), "Plan/Organize T-score > 60 (n)" = sum(Plan.Organize_Tscore >= 60))

BRIEF_AgeApp_PlanOrg_over60 %>%
    kable() %>%  
    kable_styling(bootstrap_options = "striped")

PlanOrg_60rr <- matrix(c(37,7,18,3, 19, 10, 11, 5), 4, 2, byrow=TRUE)
dimnames(PlanOrg_60rr) <- list("Group" = c("Typically Hearing", "Early ASL", "Later English", "Later ASL"), "Plan/Organize T-score" = c("Not Elevated", "Elevated"))
PlanOrg_60rr
riskratio.small(PlanOrg_60rr)
#DHH groups *not* significantly more likely to have elevated Inhibit T-scores relative to TH group, but the Later english group close
```

Checking whether Age-appropriate kids differ from non-age appropriate kids
```{r}
summary(BRIEF_AgeOf$Age.Appropriate.)

table1::label(BRIEF$AgeMonths) <- "Age (Months)"
table1::label(BRIEF$Sex) <- "Sex"
table1::label(BRIEF$Race) <- "Race"
table1::label(BRIEF$Ethnicity) <- "Ethnicity"
table1::label(BRIEF$SES..3.66.) <- "SES"
table1::label(BRIEF$LanguageGroup) <- "Language Group"


table1::table1(~AgeMonths + Sex + Race + Ethnicity + SES..3.66. + LanguageGroup | Age.Appropriate., data = BRIEF, overall=T)
```
##Shows that  ASL Later kids make up 48% of the non age-appropriate sample,  14.5% of the age-appropriate sample, and 21.6% of the overall sample

##English later kids make up 20.7% of the non age-appropriate sample,  26.4% of the age-appropriate sample, and 25.2% of the overall sample

##This is to say that kids in the Later group, and specifically Later ASL, are probably over-represented in the not having received age appropriate BRIEF
##The finding that LATER exposed kids tend to have more elevated scores, is evidence AGAINST the suggestion that there might be questions on the BRIEF-P that may not be appropriate for older kids? If the behaviors the BRIEF-P asks about were not appropriate for older kids, then we would *not* expect Later exposed older kids to have elevated BRIEF scores relative to early-exposed kids (but they do). 


####Comparing stepwise models with AoAE added first
To determine the effect of Age of Language Exposure on top of Age of Auditory Exposure 
```{r}
overall_all_base <- lm(data=BRIEF_AgeOf, formula = GEC_RawScore~SES..3.66.+Sex+AgeMonths)
summary(overall_all_base)
overall_all_AoAE <- lm(data=BRIEF_AgeOf, formula = GEC_RawScore~SES..3.66.+Sex+AgeMonths+AoAE)
summary(overall_all_AoAE)

anova(overall_all_base, overall_all_AoAE)

overall_all_AoAE_AoLE <- lm(data=BRIEF_AgeOf, formula = GEC_RawScore~SES..3.66.+Sex+AgeMonths+AoAE+Age.of.Language.Exposure..mo.)
summary(overall_all_AoAE_AoLE)
anova(overall_all_AoAE, overall_all_AoAE_AoLE)
#~~~~~#

inhibition_all_base <- lm(data=BRIEF_AgeOf, formula = Inhibit_RawScore~SES..3.66.+Sex+AgeMonths)
summary(inhibition_all_base)
inhibition_all_AoAE <- lm(data=BRIEF_AgeOf, formula = Inhibit_RawScore~SES..3.66.+Sex+AgeMonths+AoAE)
summary(inhibition_all_AoAE)

anova(inhibition_all_base, inhibition_all_AoAE)

inhibition_all_AoAE_AoLE <- lm(data=BRIEF_AgeOf, formula = Inhibit_RawScore~SES..3.66.+Sex+AgeMonths+AoAE+Age.of.Language.Exposure..mo.)
summary(inhibition_all_AoAE_AoLE)
anova(inhibition_all_AoAE, inhibition_all_AoAE_AoLE)
#~~~~~#

shift_all_base <- lm(data=BRIEF_AgeOf, formula = Shift_RawScore~SES..3.66.+Sex+AgeMonths) 
summary(shift_all_base)
shift_all_AoAE <- lm(data=BRIEF_AgeOf, formula = Shift_RawScore~SES..3.66.+Sex+AgeMonths+AoAE)  
summary(shift_all_AoAE)

anova(shift_all_base, shift_all_AoAE)

shift_all_AoAE_AoLE <- lm(data=BRIEF_AgeOf, formula = Shift_RawScore~SES..3.66.+Sex+AgeMonths+AoAE+Age.of.Language.Exposure..mo.)  
summary(shift_all_AoAE_AoLE)

anova(shift_all_AoAE, shift_all_AoAE_AoLE)
#~~~~~#

emotctrl_all_base <- lm(data=BRIEF_AgeOf, formula = Emotional.Control_RawScore~SES..3.66.+Sex+AgeMonths)
emotctrl_all_AoAE <- lm(data=BRIEF_AgeOf, formula = Emotional.Control_RawScore~SES..3.66.+Sex+AgeMonths+AoAE)
summary(emotctrl_all_AoAE)

anova(emotctrl_all_base, emotctrl_all_AoAE)

emotctrl_all_AoAE_AoLE <- lm(data=BRIEF_AgeOf, formula = Emotional.Control_RawScore~SES..3.66.+Sex+AgeMonths+AoAE+Age.of.Language.Exposure..mo.)
summary(emotctrl_all_AoAE_AoLE)
anova(emotctrl_all_AoAE, emotctrl_all_AoAE_AoLE)
#~~~~~#

wm_all_base <- lm(data=BRIEF_AgeOf, formula = Working.Memory_RawScore~SES..3.66.+Sex+AgeMonths)
summary(wm_all_base)
wm_all_AoAE <- lm(data=BRIEF_AgeOf, formula = Working.Memory_RawScore~SES..3.66.+Sex+AgeMonths+AoAE)
summary(wm_all_AoAE)

anova(wm_all_base, wm_all_AoAE)

wm_all_AoAE_AoLE <- lm(data=BRIEF_AgeOf, formula = Working.Memory_RawScore~SES..3.66.+Sex+AgeMonths+AoAE+Age.of.Language.Exposure..mo.)
summary(wm_all_AoAE_AoLE)
anova(wm_all_AoAE, wm_all_AoAE_AoLE)
#~~~~~#

plan_all_base <- lm(data=BRIEF_AgeOf, formula = Plan.Organize_RawScore~SES..3.66.+Sex+AgeMonths)
summary(plan_all_base)
plan_all_AoAE <- lm(data=BRIEF_AgeOf, formula = Plan.Organize_RawScore~SES..3.66.+Sex+AgeMonths+AoAE)
summary(plan_all_AoAE)
anova(plan_all_base, plan_all_AoAE)

plan_all_AoAE_AoLE <- lm(data=BRIEF_AgeOf, formula = Plan.Organize_RawScore~SES..3.66.+Sex+AgeMonths+AoAE+Age.of.Language.Exposure..mo.)
summary(plan_all_AoAE_AoLE)
anova(plan_all_AoAE, plan_all_AoAE_AoLE)

```
###For all subscales, adding Age of Auditory Exposure to the model with demographic variables did not improve model fit (and Age of Auditory Exposure was not a significant predictor of any subsale), but subsequently adding Age of Language exposure to the model with Age of Auditory Exposure and demographic variables *did* significantly improve model fit. 
